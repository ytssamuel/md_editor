<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Editor</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/material-darker.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/eclipse.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-dark.min.css" id="hljs-theme">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles/main.css">

    <script>
        window.MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
          },
          svg: {
            fontCache: 'global'
          }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head>
<body>
    <div class="container">
        <header id="main-header">
            <h1>Markdown 編輯器</h1>
            <p class="description">即時預覽、程式碼、數學公式、Mermaid 圖表與 PDF 匯出功能</p>
            <ul class="features">
                <li class="feature-tag"><i class="fas fa-code"></i> 程式碼</li>
                <li class="feature-tag"><i class="fas fa-square-root-alt"></i> 公式</li>
                <li class="feature-tag"><i class="fas fa-project-diagram"></i> 圖表</li>
                <li class="feature-tag"><i class="fas fa-music"></i> 樂譜</li>
                <li class="feature-tag"><i class="fas fa-file-pdf"></i> PDF</li>
            </ul>
        </header>

        <div class="toolbar">
            <div class="button-bar" id="view-mode-bar">
                <button id="view-editor" data-mode="editor-only"><i class="fas fa-edit"></i> 編輯</button>
                <button id="view-both" data-mode="both" class="active-view"><i class="fas fa-columns"></i> 兼具</button>
                <button id="view-preview" data-mode="preview-only"><i class="fas fa-eye"></i> 預覽</button>
            </div>
            
            <div class="central-buttons">
                <button id="upload-btn">
                    <i class="fas fa-upload"></i>
                    上傳
                </button>
                <button id="download-btn">
                    <i class="fas fa-download"></i>
                    下載
                </button>
                <button id="export-pdf-btn">
                    <i class="fas fa-file-pdf"></i>
                    PDF 匯出
                </button>
                <button id="clear-btn" class="secondary">
                    <i class="fas fa-trash"></i>
                    清除
                </button>
                <button id="demo-btn" class="secondary">
                    <i class="fas fa-magic"></i>
                    範例內容
                </button>
            </div>

            <div class="right-buttons">
                <button id="settings-btn">
                    <i class="fas fa-cog"></i>
                    設定
                </button>
                <button id="theme-toggle-btn">
                    <i class="fas fa-sun"></i>
                    <span id="theme-text">淺色模式</span>
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".md, .markdown, text/markdown">
                <button id="top-toggle-btn" class="top-toggle-btn" title="隱藏標頭">
                    <i class="fas fa-chevron-up"></i>
                </button>
            </div>
        </div>

        <div class="split-container" id="split-container">
            <div class="panel" id="editor-panel">
                <div class="editor-container" id="editor-container">
                    <!-- CodeMirror 將會被初始化於此 -->
                </div>
            </div>

            <div class="gutter" id="gutter"></div>

            <div class="panel" id="preview-panel">
                <div class="nav-sidebar" id="nav-sidebar">
                    <div class="nav-sidebar-title">文件大綱</div>
                    <ul id="nav-list"></ul>
                </div>
                <div id="preview"></div>
            </div>
        </div>

        <footer>
            <p> Markdown 編輯器 | @2025 by ytssamuel</p>
        </footer>
    </div>

    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <p id="modal-text"></p>
            <input type="text" id="modal-input" class="modal-input" />
            <div class="modal-buttons">
                <button id="modal-ok">確定</button>
                <button id="modal-cancel" class="secondary">取消</button>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>標題顏色設定</h2>
            <div class="color-settings">
                <div class="setting-row">
                    <label for="h1-color">H1 顏色:</label>
                    <select id="h1-color">
                        <option value="default-text">黑色</option>
                        <option value="blue">藍色</option>
                        <option value="red">紅色</option>
                        <option value="orange">橘色</option>
                        <option value="green">綠色</option>
                        <option value="purple">紫色</option>
                    </select>
                </div>
                <div class="setting-row">
                    <label for="h2-color">H2 顏色:</label>
                    <select id="h2-color">
                        <option value="default-text">黑色</option>
                        <option value="blue">藍色</option>
                        <option value="red">紅色</option>
                        <option value="orange">橘色</option>
                        <option value="green">綠色</option>
                        <option value="purple">紫色</option>
                    </select>
                </div>
                <div class="setting-row">
                    <label for="h3-color">H3 顏色:</label>
                    <select id="h3-color">
                        <option value="default-text">黑色</option>
                        <option value="blue">藍色</option>
                        <option value="red">紅色</option>
                        <option value="orange">橘色</option>
                        <option value="green">綠色</option>
                        <option value="purple">紫色</option>
                    </select>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="save-settings">儲存</button>
                <button id="reset-settings" class="secondary">還原預設值</button>
            </div>
        </div>
    </div>

    <!-- CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/mode/overlay.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/gfm/gfm.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/marked@4.0.10/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/abcjs@6.2.0/dist/abcjs-basic-min.js"></script>
    <script type="module" src="scripts/main.js"></script>
</body>
</html>